#include <unistd.h>
#include <string.h>

void filter(char *input, int input_len, char *sub, int sub_len);

int main(int ac, char **av)
{
	//if arg count is wrong
	
	int sub_len = strlen(av[1]);


	char buffer[1024];
	
	int bytes_read = read(STDIN_FILENO, buffer, sizeof(buffer));
	while (bytes_read > 0)
	{
		filter_str(buffer, bytes_read, av[1], sub_len);
		bytes_read = read(STDIN_FILENO, buffer, sizeof(buffer));
	}
	if (bytes_read < 0)
		return 1;
	return 0;
}

void filter(char *input, int input_len, char *sub, int sub_len)
{
	char *current = input;
	char *match;

	match = memmem(current, input_len, sub, sub_len);
	while (match)
	{
		//write everything tillmatch
		write(STDOUT_FILENO, current, match - current);
		//print * sublen times
		int i = 0;
		while (i < sub_len)
		{
			write(1, "*", 1);
			i++;
		}
		//update current
		current = match + sub_len;
		//call matcha gain
		match = memmem(current, input_len - (current - input), sub, sub_len);
	}
	//write till end of line
	write(1, current, input_len - (current - input));
}
